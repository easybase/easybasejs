!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.EasyBase=t():e.EasyBase=t()}(window,(function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=45)}([function(e,t,r){const n=r(18),o=r(19),s=r(9);e.exports={...n,...o,...s}},function(e,t){var r="undefined"!=typeof self?self:this,n=function(){function e(){this.fetch=!1,this.DOMException=r.DOMException}return e.prototype=r,new e}();!function(e){!function(t){var r="URLSearchParams"in e,n="Symbol"in e&&"iterator"in Symbol,o="FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),s="FormData"in e,i="ArrayBuffer"in e;if(i)var a=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],u=ArrayBuffer.isView||function(e){return e&&a.indexOf(Object.prototype.toString.call(e))>-1};function c(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function l(e){return"string"!=typeof e&&(e=String(e)),e}function p(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return n&&(t[Symbol.iterator]=function(){return t}),t}function f(e){this.map={},e instanceof f?e.forEach((function(e,t){this.append(t,e)}),this):Array.isArray(e)?e.forEach((function(e){this.append(e[0],e[1])}),this):e&&Object.getOwnPropertyNames(e).forEach((function(t){this.append(t,e[t])}),this)}function d(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function h(e){return new Promise((function(t,r){e.onload=function(){t(e.result)},e.onerror=function(){r(e.error)}}))}function y(e){var t=new FileReader,r=h(t);return t.readAsArrayBuffer(e),r}function g(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function m(){return this.bodyUsed=!1,this._initBody=function(e){var t;this._bodyInit=e,e?"string"==typeof e?this._bodyText=e:o&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:s&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:r&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():i&&o&&((t=e)&&DataView.prototype.isPrototypeOf(t))?(this._bodyArrayBuffer=g(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):i&&(ArrayBuffer.prototype.isPrototypeOf(e)||u(e))?this._bodyArrayBuffer=g(e):this._bodyText=e=Object.prototype.toString.call(e):this._bodyText="",this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):r&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},o&&(this.blob=function(){var e=d(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?d(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(y)}),this.text=function(){var e,t,r,n=d(this);if(n)return n;if(this._bodyBlob)return e=this._bodyBlob,t=new FileReader,r=h(t),t.readAsText(e),r;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),r=new Array(t.length),n=0;n<t.length;n++)r[n]=String.fromCharCode(t[n]);return r.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},s&&(this.formData=function(){return this.text().then(E)}),this.json=function(){return this.text().then(JSON.parse)},this}f.prototype.append=function(e,t){e=c(e),t=l(t);var r=this.map[e];this.map[e]=r?r+", "+t:t},f.prototype.delete=function(e){delete this.map[c(e)]},f.prototype.get=function(e){return e=c(e),this.has(e)?this.map[e]:null},f.prototype.has=function(e){return this.map.hasOwnProperty(c(e))},f.prototype.set=function(e,t){this.map[c(e)]=l(t)},f.prototype.forEach=function(e,t){for(var r in this.map)this.map.hasOwnProperty(r)&&e.call(t,this.map[r],r,this)},f.prototype.keys=function(){var e=[];return this.forEach((function(t,r){e.push(r)})),p(e)},f.prototype.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),p(e)},f.prototype.entries=function(){var e=[];return this.forEach((function(t,r){e.push([r,t])})),p(e)},n&&(f.prototype[Symbol.iterator]=f.prototype.entries);var b=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function w(e,t){var r,n,o=(t=t||{}).body;if(e instanceof w){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new f(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,o||null==e._bodyInit||(o=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",!t.headers&&this.headers||(this.headers=new f(t.headers)),this.method=(r=t.method||this.method||"GET",n=r.toUpperCase(),b.indexOf(n)>-1?n:r),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&o)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(o)}function E(e){var t=new FormData;return e.trim().split("&").forEach((function(e){if(e){var r=e.split("="),n=r.shift().replace(/\+/g," "),o=r.join("=").replace(/\+/g," ");t.append(decodeURIComponent(n),decodeURIComponent(o))}})),t}function v(e,t){t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new f(t.headers),this.url=t.url||"",this._initBody(e)}w.prototype.clone=function(){return new w(this,{body:this._bodyInit})},m.call(w.prototype),m.call(v.prototype),v.prototype.clone=function(){return new v(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new f(this.headers),url:this.url})},v.error=function(){var e=new v(null,{status:0,statusText:""});return e.type="error",e};var x=[301,302,303,307,308];v.redirect=function(e,t){if(-1===x.indexOf(t))throw new RangeError("Invalid status code");return new v(null,{status:t,headers:{location:e}})},t.DOMException=e.DOMException;try{new t.DOMException}catch(e){t.DOMException=function(e,t){this.message=e,this.name=t;var r=Error(e);this.stack=r.stack},t.DOMException.prototype=Object.create(Error.prototype),t.DOMException.prototype.constructor=t.DOMException}function A(e,r){return new Promise((function(n,s){var i=new w(e,r);if(i.signal&&i.signal.aborted)return s(new t.DOMException("Aborted","AbortError"));var a=new XMLHttpRequest;function u(){a.abort()}a.onload=function(){var e,t,r={status:a.status,statusText:a.statusText,headers:(e=a.getAllResponseHeaders()||"",t=new f,e.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach((function(e){var r=e.split(":"),n=r.shift().trim();if(n){var o=r.join(":").trim();t.append(n,o)}})),t)};r.url="responseURL"in a?a.responseURL:r.headers.get("X-Request-URL");var o="response"in a?a.response:a.responseText;n(new v(o,r))},a.onerror=function(){s(new TypeError("Network request failed"))},a.ontimeout=function(){s(new TypeError("Network request failed"))},a.onabort=function(){s(new t.DOMException("Aborted","AbortError"))},a.open(i.method,i.url,!0),"include"===i.credentials?a.withCredentials=!0:"omit"===i.credentials&&(a.withCredentials=!1),"responseType"in a&&o&&(a.responseType="blob"),i.headers.forEach((function(e,t){a.setRequestHeader(t,e)})),i.signal&&(i.signal.addEventListener("abort",u),a.onreadystatechange=function(){4===a.readyState&&i.signal.removeEventListener("abort",u)}),a.send(void 0===i._bodyInit?null:i._bodyInit)}))}A.polyfill=!0,e.fetch||(e.fetch=A,e.Headers=f,e.Request=w,e.Response=v),t.Headers=f,t.Request=w,t.Response=v,t.fetch=A,Object.defineProperty(t,"__esModule",{value:!0})}({})}(n),n.fetch.ponyfill=!0,delete n.fetch.polyfill;var o=n;(t=o.fetch).default=o.fetch,t.fetch=o.fetch,t.Headers=o.Headers,t.Request=o.Request,t.Response=o.Response,e.exports=t},function(e,t,r){const{isObject:n,buildCall:o,mapJoin:s,objectMapJoin:i}=r(0),a=r(4),u=r(3);e.exports=(e,t,r=0,n=t.length)=>{n>t.length&&(n=t.length);let o="";for(let s=r;s<n;++s){const n=t[s];s!==r&&(o+=n.join),o+=p(e,n.args),n.on?o+=" on "+a(e,n.on):n.using&&(o+=` using (${c(e,n.using)})`)}return o};const c=s(o(s((e,t)=>{if("string"==typeof t)return t;if("function"==typeof t)return e.build(t);throw Error("Error: Invalid .using arg")}))),l=i((e,t,r)=>{if("string"==typeof r)return`${r} ${e.mapKey(t)}`;if("function"==typeof r)return`${e.build(r)} ${e.mapKey(t)}`;if(Array.isArray(r)){const{columns:n,values:o}=u(e,r);return`(${o}) ${e.mapKey(t)}(${n})`}throw Error("Error: Invalid .from argument")}),p=o(s((e,t)=>{if("string"==typeof t)return t;if("function"==typeof t)return e.build(t);if(n(t))return l(e,t);throw Error("Error: Invalid .from argument:",t)}))},function(e,t,r){const{mapJoin:n}=r(0);e.exports=(e,t)=>{const r=o(t);return{columns:s(e,r),values:i(e,t,r)}};const o=e=>{const t={};for(const r of e)for(const e in r)t[e]=!0;return Object.keys(t)},s=n((e,t)=>e.mapKey(t)),i=(e,t,r)=>{let n="values ";for(let o=0;o<t.length;++o){0!==o&&(n+=", "),n+="(";const s=t[o];for(let t=0;t<r.length;++t)0!==t&&(n+=", "),n+=a(e,s[r[t]]);n+=")"}return n},a=(e,t)=>void 0===t?"default":e.build(t)},function(e,t,r){const{isTaggedTemplate:n,buildTaggedTemplate:o,isObject:s,mapJoin:i,objectMapJoin:a}=r(0),u=i((e,t)=>e.build(t)),c=a((e,t,r)=>{const n=e.mapKey(t);return null===r?`(${n} is null)`:Array.isArray(r)?`(${n} in (${u(e,r)}))`:`(${n} = ${e.build(r)})`}," and ");var l;e.exports=i((l=i((e,t)=>s(t)?c(e,t):e.build(t)," and "),(e,t)=>n(t)?`(${o(e,t)})`:l(e,t))," and ")},function(e,t,r){"use strict";e.exports=function e(t,r){if(t===r)return!0;if(t&&r&&"object"==typeof t&&"object"==typeof r){if(t.constructor!==r.constructor)return!1;var n,o,s;if(Array.isArray(t)){if((n=t.length)!=r.length)return!1;for(o=n;0!=o--;)if(!e(t[o],r[o]))return!1;return!0}if(t.constructor===RegExp)return t.source===r.source&&t.flags===r.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===r.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===r.toString();if((n=(s=Object.keys(t)).length)!==Object.keys(r).length)return!1;for(o=n;0!=o--;)if(!Object.prototype.hasOwnProperty.call(r,s[o]))return!1;for(o=n;0!=o--;){var i=s[o];if(!e(t[i],r[i]))return!1}return!0}return t!=t&&r!=r}},function(e,t,r){const n=r(13)({dialect:r(20)});n.from=void 0,e.exports=n},function(e,t,r){const{isObject:n,buildCall:o,mapJoin:s,objectMapJoin:i}=r(0),a=i((e,t,r)=>`${"string"==typeof r?r:e.build(r)} ${e.mapKey(t)}`);e.exports=s(o(s((e,t)=>"string"==typeof t?t:n(t)?a(e,t):e.build(t))))},function(e,t,r){const{isTaggedTemplate:n,buildTaggedTemplate:o}=r(0);e.exports=(e,t)=>{if(n(t))return o(e,t);const r=t[0];if("number"==typeof r)return e.parameterize(r);if("function"==typeof r)return e.build(r);throw Error("Error: Invalid limit/offset argument")}},function(e,t){e.exports={isTaggedTemplate:([e])=>Array.isArray(e)&&e.raw,buildTaggedTemplate:(e,[t,...r])=>{let n=t[0];for(let o=0;o<r.length;++o)n+=e.build(r[o])+t[o+1];return n}}},function(e,t,r){e.exports={wth:r(25),select:r(26),from:r(27),where:r(28),group:r(29),having:r(30),setop:r(31),order:r(32),limit:r(33),offset:r(34),del:r(35),returning:r(36),insert:r(37),update:r(38),set:r(39)}},function(e){e.exports=JSON.parse('["ase","art","bmp","blp","cd5","cit","cpt","cr2","cut","dds","dib","djvu","egt","exif","gif","gpl","grf","icns","ico","iff","jng","jpeg","jpg","jfif","jp2","jps","lbm","max","miff","mng","msp","nitf","ota","pbm","pc1","pc2","pc3","pcf","pcx","pdn","pgm","PI1","PI2","PI3","pict","pct","pnm","pns","ppm","psb","psd","pdd","psp","px","pxm","pxr","qfx","raw","rle","sct","sgi","rgb","int","bw","tga","tiff","tif","vtf","xbm","xcf","xpm","3dv","amf","ai","awg","cgm","cdr","cmx","dxf","e2d","egt","eps","fs","gbr","odg","svg","stl","vrml","x3d","sxd","v2d","vnd","wmf","emf","art","xar","png","webp","jxr","hdp","wdp","cur","ecw","iff","lbm","liff","nrrd","pam","pcx","pgf","sgi","rgb","rgba","bw","int","inta","sid","ras","sun","tga"]')},function(e){e.exports=JSON.parse('["3g2","3gp","aaf","asf","avchd","avi","drc","flv","m2v","m4p","m4v","mkv","mng","mov","mp2","mp4","mpe","mpeg","mpg","mpv","mxf","nsv","ogg","ogv","qt","rm","rmvb","roq","svi","vob","webm","wmv","yuv"]')},function(e,t,r){const n=r(14),o=r(16),{memoize:s,normalKey:i}=r(0);function a(e){if(void 0===e)throw Error("Error: undefined argument");if("function"==typeof e){if(e._build){const{type:t,text:r}=e._build(this);return"expression"===t||"fragment"===t?r:`(${r})`}return e(this)}return this.unparameterized?this.escape(e):this.parameterize(e)}e.exports=({dialect:e})=>(t={})=>{const{query:r,expression:u,parameterize:c,escape:l}=e,p={parameterize:c,escape:l,mapKey:s(i),build:a},f=o({defaultContext:p,expression:u});return n({defaultContext:p,query:r,e:f,config:t})}},function(e,t,r){const n=r(15),o=e=>{const t=r=>{const n=(...e)=>t({name:"express",args:e,prev:r});return n.method=r,Object.setPrototypeOf(n,e),n};return t},s=e=>{const t={};for(const r in e){const{updateContext:n,properties:o={}}=e[r];t[r]=n;for(const e in o)t[`${r}.${e}`]=o[e]}return t},i=e=>(t,r)=>{const n=[];for(;void 0!==t;t=t.prev)n.push(t);const o={id:0};for(let t=n.length-1;t>=0;--t){const s=n[t];e[s.name](r,s.args,o)}return r},a=({newContext:e,updateContext:t,queries:r})=>({_build:{value:function(n){const o=t(this.method,e(n));return r[o.type](o)}},query:{get:function(){return this._build()}},unparameterized:{get:function(){return this._build({unparameterized:!0}).text}}}),u=({methods:e,chain:t})=>{const r={};for(const n in e){const{getter:o}=e[n];r[n]=o?{get:function(){return t({name:n,prev:this.method})}}:{value:function(...e){return t({name:n,args:e,prev:this.method})}}}return r};e.exports=({defaultContext:e,query:t,e:r,config:c})=>{const{queries:l,methods:p,properties:f}=t,d=n(e),h=s(p),y=i(h);h.extend=(e,t)=>{const r=Array.isArray(t[0])?t[0]:t;for(let t=0;t<r.length;++t)y(r[t].method,e)};const g=()=>{},m=o(g),b={one:{value:async function(){return await c.oneCallback(this.query,c.tableName,c.userAssociatedRecordsOnly)}},all:{value:async function(){return await c.allCallback(this.query,c.tableName,c.userAssociatedRecordsOnly)}},_tableName:{get:function(){return c.tableName}}},w=u({methods:p,chain:m});return delete w.from,Object.defineProperties(g,{...a({chain:m,newContext:d,updateContext:y,queries:l}),...w,...b,...f,e:{value:r}}),m()}},function(e,t){e.exports=e=>{const{parameterize:t,escape:r,mapKey:n,build:o}=e;return(e={})=>{const{params:s=[],unparameterized:i=!1}=e,a=[];return{parameterize:t,escape:r,mapKey:n,build:o,params:s,unparameterized:i,type:"select",target:a,join:void 0,separator:" ",sql:[],ret:[],frm:[],whr:a,grp:[],hav:[],setop:[],ord:[],with:[],set:[]}}}},function(e,t,r){const n=r(17),{normalKey:o}=r(0),s=e=>t=>`${e}(${o(t)})`;e.exports=({defaultContext:e,expression:t})=>{const{expressions:r}=t,o=a(e),l=n(r),p=()=>{},f=u(p);Object.defineProperties(p,{...i({compile:l,newContext:o}),...c({expressions:r,chain:f})});const d=f();return d.max=s("max"),d.min=s("min"),d.avg=s("avg"),d.count=s("count"),d.sum=s("sum"),d};const i=({compile:e,newContext:t})=>({_build:{value:function(r){return e(t(r),this.current)}},query:{get:function(){return this._build()}},unparameterized:{get:function(){return this._build({unparameterized:!0}).text}}}),a=e=>{const{build:t,parameterize:r,escape:n,mapKey:o}=e;return e=>{const{params:s=[],unparameterized:i=!1}=e||{};return{build:t,parameterize:r,escape:n,mapKey:o,params:s,unparameterized:i}}},u=e=>{const t=r=>{const n=(...e)=>t({prev:r,args:e});return n.current=r,Object.setPrototypeOf(n,e),n};return t},c=({expressions:e,chain:t})=>{const r={};for(const n in e)r[n]={get:function(){return t({prev:this.current,name:n})}};return r}},function(e,t,r){const{isTaggedTemplate:n}=r(0),o=e=>{const t=[];for(;e;e=e.prev)t.push(e);if(0===t.length)throw Error("Error: Empty expression");let r={name:"arg",args:[]};const n=[r],o=t.length-1;for(let e=o;e>=0;--e){const{name:i,args:a}=t[e];e===o?i?r.name=i:s(r.args,a):i?n.push(r={name:i,args:[void 0]}):s(r.args,a)}return n},s=(e,t)=>{if(n(t))e.push({tag:t});else{if(0===t.length)throw Error("Error: Expression call requires at least one argument");for(let r=0;r<t.length;++r)e.push({arg:t[r]})}},i=e=>(t,r)=>{let n;for(let o=0;o<r.length;++o){const{name:s,args:i}=r[o],{build:a,minArgs:u,maxArgs:c}=e[s];0!==o&&(i[0]={exp:n});const l=i.length;if(l<u)throw Error(`Error: ${s} requires at least ${u} arguments`);if(l>c)throw Error(`Error: ${s} accepts at most ${c} arguments`);n=a(t,i)}return n};e.exports=e=>{const t=i(e);return(e,r)=>{const n=o(r);return{text:t(e,n),args:e.params,type:"expression"}}}},function(e,t,r){const{isTaggedTemplate:n,buildTaggedTemplate:o}=r(9);e.exports={isObject:e=>e&&e.constructor.prototype===Object.prototype,buildCall:e=>(t,r)=>n(r)?o(t,r):e(t,r),mapJoin:(e,t=", ")=>(r,n)=>{let o="";for(let s=0;s<n.length;++s)0!==s&&(o+=t),o+=e(r,n[s]);return o},mapJoinWrap:(e,t=", ",r="(",n=")")=>(o,s)=>{let i=r;for(let r=0;r<s.length;++r)0!==r&&(i+=t),i+=e(o,s[r]);return i+n},objectMapJoin:(e,t=", ")=>(r,n)=>{let o="";const s=Object.keys(n);for(let i=0;i<s.length;++i){0!==i&&(o+=t);const a=s[i];o+=e(r,a,n[a])}return o}}},function(e,t){e.exports={memoize:e=>{const t={};return r=>t[r]||(t[r]=e(r))},normalKey:e=>-1===e.indexOf("(")?e.toLowerCase().trim().replace(/ /g,"_"):e}},function(e,t,r){const n=r(21),o=r(41),{parameterize:s,escape:i}=r(44);e.exports={query:n,expression:o,parameterize:s,escape:i}},function(e,t,r){const{methods:n,queries:o,query:s,clauses:i,common:a}=r(22),{fromItems:u,expressions:c}=a,{wth:l,from:p,where:f,group:d,having:h,setop:y,order:g,limit:m,offset:b,returning:w,set:E}=i;e.exports={methods:{...n,distinctOn:{updateContext:(e,t)=>{e.distinct?e.distinct.push(t):e.distinct=[t]}}},queries:{...o,select:s(l,e=>{let t="select ";return e.distinct&&(t+="distinct ",e.distinct.length&&(t+=`on (${c(e,e.distinct)}) `)),t+=c(e,e.ret)||"*",t},p,f,d,h,y,g,m,b),delete:s(l,e=>{const t=u(e,e.frm,0,1);return t&&"delete from "+t},e=>{const t=u(e,e.frm,1);return t&&"using "+t},f,w),update:s(l,e=>{const t=u(e,e.frm,0,1);return t&&"update "+t},E,e=>{const t=u(e,e.frm,1);return t&&"from "+t},f,w)},properties:{rollup:{value:(...e)=>({type:"rollup",args:e})},cube:{value:(...e)=>({type:"cube",args:e})},groupingSets:{value:(...e)=>({type:"grouping sets",args:e})}}}},function(e,t,r){const n=r(23),{query:o,queries:s}=r(24),i=r(10),a=r(40);e.exports={methods:n,query:o,queries:s,clauses:i,common:a}},function(e,t,r){const{normalKey:n}=r(0),o={with:{updateContext:(e,t)=>{e.with.push(t)}},withRecursive:{updateContext:(e,t)=>{e.recursive=!0,e.with.push(t)}},from:{updateContext:(e,t)=>{e.frm.push({args:t,join:", "})}},where:{updateContext:(e,t)=>{e.whr.push(t),e.target=e.whr}},return:{updateContext:(e,t)=>{e.ret.push(Array.isArray(t)?t.map(n):t)}},distinct:{getter:!0,updateContext:e=>{e.distinct=[]}},groupBy:{updateContext:(e,t)=>{e.grp.push(t)}},having:{updateContext:(e,t)=>{e.hav.push(t),e.target=e.hav}},union:{updateContext:(e,t)=>{e.setop.push({type:"union",args:t})}},unionAll:{updateContext:(e,t)=>{e.setop.push({type:"union all",args:t})}},intersect:{updateContext:(e,t)=>{e.setop.push({type:"intersect",args:t})}},intersectAll:{updateContext:(e,t)=>{e.setop.push({type:"intersect all",args:t})}},except:{updateContext:(e,t)=>{e.setop.push({type:"except",args:t})}},exceptAll:{updateContext:(e,t)=>{e.setop.push({type:"except all",args:t})}},orderBy:{updateContext:(e,t)=>{e.ord.push(t)}},limit:{updateContext:(e,t)=>{e.limit=t}},offset:{updateContext:(e,t)=>{e.offset=t}},join:{updateContext:(e,t)=>{e.frm.push(e.join={args:t,join:" join "})}},leftJoin:{updateContext:(e,t)=>{e.frm.push(e.join={args:t,join:" left join "})}},rightJoin:{updateContext:(e,t)=>{e.frm.push(e.join={args:t,join:" right join "})}},fullJoin:{updateContext:(e,t)=>{e.frm.push(e.join={args:t,join:" full join "})}},crossJoin:{updateContext:(e,t)=>{e.frm.push(e.join={args:t,join:" cross join "})}},naturalJoin:{updateContext:(e,t)=>{e.frm.push(e.join={args:t,join:" natural join "})}},naturalLeftJoin:{updateContext:(e,t)=>{e.frm.push(e.join={args:t,join:" natural left join "})}},naturalRightJoin:{updateContext:(e,t)=>{e.frm.push(e.join={args:t,join:" natural right join "})}},naturalFullJoin:{updateContext:(e,t)=>{e.frm.push(e.join={args:t,join:" natural full join "})}},on:{updateContext:(e,t)=>{const{join:r}=e;r.on?r.on.push(t):e.target=r.on=[t]}},using:{updateContext:(e,t)=>{const{join:r}=e;r.using?r.using.push(t):r.using=[t]}},delete:{updateContext:e=>{e.type="delete"}},insert:{updateContext:(e,t)=>{e.type="insert",e.insert=t}},set:{updateContext:(e,t)=>{e.type="update",e.set.push(t)}},express:{updateContext:(e,t,r)=>{if(0===r.id)r.id++,e.frm.push(e.join={type:"from",args:t,join:", "});else if(1===r.id)r.id++,e.whr.push(t);else{if(2!==r.id)throw Error("Invalid express call");r.id++,e.ret.push(t)}}}};e.exports=o},function(e,t,r){const{wth:n,select:o,from:s,where:i,group:a,having:u,setop:c,order:l,limit:p,offset:f,del:d,returning:h,insert:y,update:g,set:m}=r(10),b=(...e)=>t=>{let r="";for(const n of e){const e=n&&n(t);e&&(r&&(r+=t.separator),r+=e)}return{text:r,args:t.params,type:t.userType||t.type}},w={select:b(n,o,s,i,a,u,c,l,p,f),update:b(n,g,m,i,h),delete:b(n,d,i,h),insert:b(n,y,h)};e.exports={query:b,queries:w}},function(e,t,r){const{isObject:n,buildCall:o,mapJoin:s,objectMapJoin:i}=r(0),a=r(3);e.exports=e=>{if(0===e.with.length)return;const t=c(e,e.with);return t&&`with ${e.recursive?"recursive ":""}${t}`};const u=i((e,t,r)=>{if("function"==typeof r)return`${e.mapKey(t)} ${e.build(r)}`;if(Array.isArray(r)){const{columns:n,values:o}=a(e,r);return`${e.mapKey(t)}(${n}) (${o})`}throw Error("Error: Invalid .with argument")}),c=s(o(s((e,t)=>{if(n(t))return u(e,t);throw Error("Invalid with argument:",t)})))},function(e,t,r){const n=r(7);e.exports=e=>`select ${o(e)}${n(e,e.ret)||"*"}`;const o=e=>e.distinct?e.distinct.length?`distinct on (${n(e,e.distinct)})`:"distinct":""},function(e,t,r){const n=r(2);e.exports=e=>{const t=n(e,e.frm);return t&&"from "+t}},function(e,t,r){const n=r(4);e.exports=e=>{if(0===e.whr.length)return;const t=n(e,e.whr);return t&&"where "+t}},function(e,t,r){const{isObject:n,buildCall:o,mapJoin:s,mapJoinWrap:i}=r(0);e.exports=e=>{if(0===e.grp.length)return;const t=f(e,e.grp);return t&&"group by "+t};const a=(e,t)=>{if("string"==typeof t)return t;if("function"==typeof t)return e.build(t);if(Array.isArray(t))return u(e,t);if(n(t))return p(e,t);throw Error("Invalid order by argument:",t)},u=i(a),c=(e,t)=>{if("string"==typeof t)return t;if("function"==typeof t)return e.build(t);if(Array.isArray(t))return l(e,t);throw Error("Invalid cube/rollup argument")},l=i(c),p=(e,t)=>{const{type:r,args:n}=t;if("rollup"===r)return"rollup "+c(e,n);if("cube"===r)return"cube "+c(e,n);if("grouping sets"===r)return"grouping sets "+a(e,n);throw Error("Invalid group by argument")},f=s(o(s(a)))},function(e,t,r){const n=r(4);e.exports=e=>{if(0===e.hav.length)return;const t=n(e,e.hav);return t&&"having "+t}},function(e,t){e.exports=e=>{if(0===e.setop.length)return;let t="",r=!0;const{setop:n}=e;for(let o=0;o<n.length;++o){const{type:n,args:s}=e.setop[o];for(let o=0;o<s.length;++o)r?r=!1:t+=" ",t+=`${n} ${e.build(s[o])}`}return t}},function(e,t,r){const{isObject:n,buildCall:o,mapJoin:s}=r(0);e.exports=e=>{if(0===e.ord.length)return;const t=a(e,e.ord);return t&&"order by "+t};const i=(e,t)=>{let r="";const{by:n,sort:o,using:s,nulls:i}=t;if("string"==typeof n)r+=n;else{if("function"!=typeof n)throw Error('Invalid order by property "by"');r+=e.build(n)}if(o)if("desc"===o)r+=" desc";else if("asc"===o)r+=" asc";else{if("string"!=typeof o)throw Error('Invalid order by property "sort"');r+=" using "+o}else if(s){if("string"!=typeof s)throw Error('Invalid order by property "using"');r+=" using "+s}if(void 0===i);else if("last"===i)r+=" nulls last";else{if("first"!==i)throw Error('Invalid order by property "nulls"');r+=" nulls first"}return r},a=s(o(s((e,t)=>{if("string"==typeof t)return t;if("function"==typeof t)return e.build(t);if(n(t))return i(e,t);throw Error("Invalid order by argument:",t)})))},function(e,t,r){const n=r(8);e.exports=e=>e.limit&&"limit "+n(e,e.limit)},function(e,t,r){const n=r(8);e.exports=e=>e.offset&&"offset "+n(e,e.offset)},function(e,t,r){const n=r(2);e.exports=e=>{const t=n(e,e.frm);return t&&"delete from "+t}},function(e,t,r){const n=r(7);e.exports=e=>{if(!e.ret)return;const t=n(e,e.ret);return t&&"returning "+t}},function(e,t,r){const{isTaggedTemplate:n,buildTaggedTemplate:o}=r(0),s=r(2),i=r(3);e.exports=e=>`insert into ${s(e,e.frm)}${a(e,e.insert)}`;const a=(e,t)=>n(t)?" "+o(e,t):1===t.length&&void 0===t[0]?" default values":Array.isArray(t[0])?u(e,t[0]):"function"==typeof t[0]?" "+e.build(t[0]):u(e,t),u=(e,t)=>{const{values:r,columns:n}=i(e,t);return`(${n}) ${r}`}},function(e,t,r){const n=r(2);e.exports=e=>{const t=n(e,e.frm);return t&&"update "+t}},function(e,t,r){const{buildCall:n,mapJoin:o,objectMapJoin:s}=r(0);e.exports=e=>{if(!e.set)return;const t=i(e,e.set);return t&&"set "+t};const i=o(n(o(s((e,t,r)=>`${e.mapKey(t)} = ${e.build(r)}`))))},function(e,t,r){const n=r(4),o=r(7),s=r(2),i=r(8),a=r(3);e.exports={conditions:n,expressions:o,fromItems:s,limitOffset:i,valuesArray:a}},function(e,t,r){const n=r(42);e.exports={expressions:n}},function(e,t,r){const{unaryPre:n,unaryPost:o,unaryFunction:s,binary:i,ternary:a,nary:u,naryFunction:c,oneValue:l,compositeValue:p,membership:f,quantifiedComparison:d,dateBinary:h}=r(43),y={arg:p,row:p,unknown:l,boolean:l,number:l,string:l,array:l,json:l,table:l},g={and:u("and"),or:u("or"),not:s("not"),isTrue:o("is true"),isNotTrue:o("is not true"),isFalse:o("is false"),isNotFalse:o("is not false"),isUnknown:o("is unknown"),isNotUnknown:o("is not unknown")},m={eq:i("="),neq:i("<>"),lt:i("<"),gt:i(">"),lte:i("<="),gte:i(">="),between:a("between","and"),isDistinctFrom:i("is distinct from"),isNotDistinctFrom:i("is not distinct from"),isNull:o("is null"),isNotNull:o("is not null"),in:f("in"),notIn:f("not in"),eqAny:d("= any"),neqAny:d("<> any"),ltAny:d("< any"),gtAny:d("> any"),lteAny:d("<= any"),gteAny:d(">= any"),eqAll:d("= all"),neqAll:d("<> all"),ltAll:d("< all"),gtAll:d("> all"),lteAll:d("<= all"),gteAll:d(">= all")},b={dateLt:h("<"),dateGt:h(">"),dateLte:h("<="),dateGte:h(">=")},w={add:i("+"),sub:i("-"),mul:i("*"),div:i("/"),mod:i("%"),exp:i("%"),sqrt:n("|/"),cbrt:n("||/"),fact:n("!!"),abs:s("abs")},E={like:i("like"),notLike:i("not like")},v={unnest:c("unnest")};e.exports={...y,...g,...m,...w,...v,...b,...E}},function(e,t,r){const{buildTaggedTemplate:n}=r(0),o=(e,t)=>t.exp?t.exp:t.tag?n(e,t.tag):e.build(t.arg),s={minArgs:1,maxArgs:1,build:(e,t)=>o(e,t[0])},i={minArgs:1,maxArgs:Number.MAX_SAFE_INTEGER,build:(e,t)=>{if(1===t.length)return o(e,t[0]);let r="";for(let n=0;n<t.length;++n)0!==n&&(r+=", "),r+=o(e,t[n]);return t.length>1?`(${r})`:r}};e.exports={build:o,unaryFunction:e=>({minArgs:1,maxArgs:1,build:(t,r)=>`${e}(${o(t,r[0])})`}),unaryPre:e=>({minArgs:1,maxArgs:1,build:(t,r)=>`(${e} ${o(t,r[0])})`}),unaryPost:e=>({minArgs:1,maxArgs:1,build:(t,r)=>`(${o(t,r[0])} ${e})`}),binary:e=>({minArgs:2,maxArgs:2,build:(t,r)=>`(${o(t,r[0])} ${e} ${o(t,r[1])})`}),ternary:(e,t)=>({minArgs:3,maxArgs:3,build:(r,n)=>`(${o(r,n[0])} ${e} ${o(r,n[1])} ${t} ${o(r,n[2])})`}),nary:e=>({minArgs:1,maxArgs:Number.MAX_SAFE_INTEGER,build:(t,r)=>{if(1===r.length)return o(t,r[0]);let n="(";for(let s=0;s<r.length;++s)0!==s&&(n+=` ${e} `),n+=o(t,r[s]);return n+")"}}),naryFunction:e=>({minArgs:1,maxArgs:Number.MAX_SAFE_INTEGER,build:(t,r)=>{let n=e+"(";for(let e=0;e<r.length;++e)0!==e&&(n+=", "),n+=o(t,r[e]);return n+")"}}),oneValue:s,compositeValue:i,membership:e=>({minArgs:2,maxArgs:2,build:(t,[r,n])=>`(${o(t,r)} ${e} ${Array.isArray(n.arg)?((e,t)=>{if(0===t.length)throw Error("Error: .in operation values list empty");let r="(";for(let n=0;n<t.length;++n)0!==n&&(r+=", "),r+=e.build(t[n]);return r+")"})(t,n.arg):o(t,n)})`}),quantifiedComparison:e=>({minArgs:2,maxArgs:2,build:(t,r)=>`(${o(t,r[0])} ${e}(${o(t,r[1])}))`}),dateBinary:e=>({minArgs:2,maxArgs:2,build:(t,r)=>{const n=r[1].arg;var s;return"function"==typeof n.getMonth&&(r[1].arg=[(s=n).getFullYear(),("0"+(s.getMonth()+1)).slice(-2),("0"+s.getDate()).slice(-2)].join("-")),`date(${o(t,r[0])}, 'YYYY-MM-DD') ${e} ${o(t,r[1])}`}})}},function(e,t){const r=e=>{if(void 0===e)throw Error("Error: parameter is undefined");if(null===e)return"null";if("string"==typeof e)return n(e);if("number"==typeof e)return""+e;if("boolean"==typeof e)return""+e;if("object"==typeof e)return Array.isArray(e)?`array[${e.map(e=>r(e)).join(", ")}]`:n(JSON.stringify(e));throw Error(`Invalid argument SQL argument of type '${typeof e}'`,e)},n=e=>{let t=!1,r="'";for(let n=0;n<e.length;n++){const o=e[n];"'"===o?r+=o+o:"\\"===o?(r+=o+o,t=!0):r+=o}return r+="'",!0===t&&(r=" E"+r),r};e.exports={parameterize:function(e){if(void 0===e)throw Error("Error: parameter is undefined");return"$"+this.params.push(e)},escape:r}},function(e,t,r){"use strict";r.r(t),r.d(t,"EasybaseProvider",(function(){return F})),r.d(t,"get",(function(){return Y})),r.d(t,"post",(function(){return G})),r.d(t,"update",(function(){return Q})),r.d(t,"Delete",(function(){return H})),r.d(t,"callFunction",(function(){return W}));var n,o,s,i,a=r(1),u=r.n(a);!function(e){e.UPLOAD_ATTACHMENT="upload_attachment",e.HANDSHAKE="handshake",e.VALID_TOKEN="valid_token",e.GET_FRAME="get_frame",e.TABLE_SIZE="table_size",e.COLUMN_TYPES="column_types",e.SYNC_STACK="sync_stack",e.SYNC_DELETE="sync_delete",e.SYNC_INSERT="sync_insert",e.GET_QUERY="get_query",e.USER_ATTRIBUTES="user_attributes",e.SET_ATTRIBUTE="set_attribute",e.SIGN_UP="sign_up",e.REQUEST_TOKEN="request_token",e.EASY_QB="easyqb",e.RESET_PASSWORD="reset_password",e.FORGOT_PASSWORD_SEND="forgot_password_send",e.FORGOT_PASSWORD_CONFIRM="forgot_password_confirm"}(n||(n={})),function(e){e.ERROR="error",e.PENDING="pending",e.SUCCESS="success"}(o||(o={})),function(e){e.ALL="all",e.ONE="one"}(s||(s={})),i||(i={});var c={...i};var l=r(5),p=r.n(l);const f=Symbol("observable-meta-key"),d={async:1},h={path:1,pathsOf:1,pathsFrom:1},y={[f]:{value:null},observe:{value:function(e,t){if("function"!=typeof e)throw new Error(`observer MUST be a function, got '${e}'`);const r=this[f].observers;if(r.some(t=>t[0]===e))console.warn("observer may be bound to an observable only once; will NOT rebind");else{let n;n=t?function(e){const t={};if(void 0!==e.path){if("string"!=typeof e.path||""===e.path)throw new Error('"path" option, if/when provided, MUST be a non-empty string');t.path=e.path}if(void 0!==e.pathsOf){if(e.path)throw new Error('"pathsOf" option MAY NOT be specified together with "path" option');if("string"!=typeof e.pathsOf)throw new Error('"pathsOf" option, if/when provided, MUST be a string (MAY be empty)');t.pathsOf=e.pathsOf.split(".").filter(e=>e)}if(void 0!==e.pathsFrom){if(e.path||e.pathsOf)throw new Error('"pathsFrom" option MAY NOT be specified together with "path"/"pathsOf"  option/s');if("string"!=typeof e.pathsFrom||""===e.pathsFrom)throw new Error('"pathsFrom" option, if/when provided, MUST be a non-empty string');t.pathsFrom=e.pathsFrom}const r=Object.keys(e).filter(e=>!h.hasOwnProperty(e));if(r.length)throw new Error(`'${r.join(", ")}' is/are not a valid observer option/s`);return t}(t):{},r.push([e,n])}}},unobserve:{value:function(){const e=this[f],t=e.observers;let r=t.length;if(r){let e=arguments.length;if(e)for(;e--;){let n=r;for(;n--;)t[n][0]===arguments[e]&&(t.splice(n,1),r--)}else t.splice(0)}}}},g=function(e,t){y[f].value=t;const r=Object.defineProperties({},y);for(const n of Object.keys(e))r[n]=A(e[n],n,t);return r},m=function(e,t){let r=0,n=e.length;y[f].value=t;const o=Object.defineProperties(new Array(n),y);for(;r<n;r++)o[r]=A(e[r],r,t);return o},b=function(e,t){return y[f].value=t,Object.defineProperties(e,y),e},w=function(e,t){let r=t;if(e.path){const n=e.path;r=t.filter(e=>e.path.join(".")===n)}else if(e.pathsOf){const n=e.pathsOf;r=t.filter(e=>e.path.length===n.length+1||e.path.length===n.length&&("reverse"===e.type||"shuffle"===e.type))}else if(e.pathsFrom){const n=e.pathsFrom;r=t.filter(e=>e.path.join(".").startsWith(n))}return r},E=function(e,t){try{e(t)}catch(r){console.error(`failed to notify listener ${e} with ${t}`,r)}},v=function(){const e=this.batches;this.batches=null;for(const[t,r]of e)E(t,r)},x=function(e,t){let r,n,o,s,i,a,u,c=e;const l=t.length;do{for(r=c.observers,i=r.length;i--;)if([n,o]=r[i],s=w(o,t),s.length)if(c.options.async){c.batches||(c.batches=[],queueMicrotask(v.bind(c)));let e=c.batches.find(e=>e[0]===n);e||(e=[n,[]],c.batches.push(e)),Array.prototype.push.apply(e[1],s)}else E(n,s);let e;if(c.parent){e=new Array(l);for(let r=0;r<l;r++)u=t[r],a=[c.ownKey,...u.path],e[r]={type:u.type,path:a,value:u.value,oldValue:u.oldValue,object:u.object};t=e,c=c.parent}else c=null}while(c)},A=function(e,t,r){return e&&"object"==typeof e?Array.isArray(e)?new N({target:e,ownKey:t,parent:r}).proxy:ArrayBuffer.isView(e)?new k({target:e,ownKey:t,parent:r}).proxy:e instanceof Date||e instanceof Error?e:new R({target:e,ownKey:t,parent:r}).proxy:e},O=function(){const e=this[f],t=e.target;let r,n,o;for(t.reverse(),r=0,n=t.length;r<n;r++)if(o=t[r],o&&"object"==typeof o){const e=o[f];e&&(e.ownKey=r)}return x(e,[{type:"reverse",path:[],object:this}]),this},j=function(e){const t=this[f],r=t.target;let n,o,s;for(r.sort(e),n=0,o=r.length;n<o;n++)if(s=r[n],s&&"object"==typeof s){const e=s[f];e&&(e.ownKey=n)}return x(t,[{type:"shuffle",path:[],object:this}]),this},T=function(e,t,r){const n=this[f],o=n.target,s=[],i=o.length,a=o.slice(0);if(t=void 0===t?0:t<0?Math.max(i+t,0):Math.min(t,i),r=void 0===r?i:r<0?Math.max(i+r,0):Math.min(r,i),t<i&&r>t){let i;o.fill(e,t,r);for(let e,u,c=t;c<r;c++)e=o[c],o[c]=A(e,c,n),a.hasOwnProperty(c)?(u=a[c],u&&"object"==typeof u&&(i=u[f],i&&(u=i.detach())),s.push({type:"update",path:[c],value:o[c],oldValue:u,object:this})):s.push({type:"insert",path:[c],value:o[c],object:this});x(n,s)}return this},C=function(e,t,r){const n=this[f],o=n.target,s=o.length;e=e<0?Math.max(s+e,0):e,t=void 0===t?0:t<0?Math.max(s+t,0):Math.min(t,s),r=void 0===r?s:r<0?Math.max(s+r,0):Math.min(r,s);const i=Math.min(r-t,s-e);if(e<s&&e!==t&&i>0){const s=o.slice(0),a=[];o.copyWithin(e,t,r);for(let t,r,u,c=e;c<e+i;c++)t=o[c],t&&"object"==typeof t&&(t=A(t,c,n),o[c]=t),r=s[c],r&&"object"==typeof r&&(u=r[f],u&&(r=u.detach())),"object"!=typeof t&&t===r||a.push({type:"update",path:[c],value:t,oldValue:r,object:this});x(n,a)}return this},_={pop:function(){const e=this[f],t=e.target,r=t.length-1;let n=t.pop();if(n&&"object"==typeof n){const e=n[f];e&&(n=e.detach())}return x(e,[{type:"delete",path:[r],oldValue:n,object:this}]),n},push:function(){const e=this[f],t=e.target,r=arguments.length,n=new Array(r),o=t.length;for(let t=0;t<r;t++)n[t]=A(arguments[t],o+t,e);const s=Reflect.apply(t.push,t,n),i=[];for(let e=o,r=t.length;e<r;e++)i[e-o]={type:"insert",path:[e],value:t[e],object:this};return x(e,i),s},shift:function(){const e=this[f],t=e.target;let r,n,o,s,i;for(r=t.shift(),r&&"object"==typeof r&&(i=r[f],i&&(r=i.detach())),n=0,o=t.length;n<o;n++)s=t[n],s&&"object"==typeof s&&(i=s[f],i&&(i.ownKey=n));return x(e,[{type:"delete",path:[0],oldValue:r,object:this}]),r},unshift:function(){const e=this[f],t=e.target,r=arguments.length,n=new Array(r);for(let t=0;t<r;t++)n[t]=A(arguments[t],t,e);const o=Reflect.apply(t.unshift,t,n);for(let e,r=0,n=t.length;r<n;r++)if(e=t[r],e&&"object"==typeof e){const t=e[f];t&&(t.ownKey=r)}const s=n.length,i=new Array(s);for(let e=0;e<s;e++)i[e]={type:"insert",path:[e],value:t[e],object:this};return x(e,i),o},reverse:O,sort:j,fill:T,copyWithin:C,splice:function(){const e=this[f],t=e.target,r=arguments.length,n=new Array(r),o=t.length;for(let t=0;t<r;t++)n[t]=A(arguments[t],t,e);const s=0===r?0:n[0]<0?o+n[0]:n[0],i=r<2?o-s:n[1],a=Math.max(r-2,0),u=Reflect.apply(t.splice,t,n),c=t.length;let l,p,d,h;for(let e,r=0;r<c;r++)e=t[r],e&&"object"==typeof e&&(l=e[f],l&&(l.ownKey=r));for(p=0,d=u.length;p<d;p++)h=u[p],h&&"object"==typeof h&&(l=h[f],l&&(u[p]=l.detach()));const y=[];let g;for(g=0;g<i;g++)g<a?y.push({type:"update",path:[s+g],value:t[s+g],oldValue:u[g],object:this}):y.push({type:"delete",path:[s+g],oldValue:u[g],object:this});for(;g<a;g++)y.push({type:"insert",path:[s+g],value:t[s+g],object:this});return x(e,y),u}},S={reverse:O,sort:j,fill:T,copyWithin:C,set:function(e,t){const r=this[f],n=r.target,o=e.length,s=n.slice(0);t=t||0,n.set(e,t);const i=new Array(o);for(let e=t;e<o+t;e++)i[e-t]={type:"update",path:[e],value:n[e],oldValue:s[e],object:this};x(r,i)}};class P{constructor(e,t){const{target:r,parent:n,ownKey:o}=e;n&&void 0!==o?(this.parent=n,this.ownKey=o):(this.parent=null,this.ownKey=null);const s=t(r,this);this.observers=[],this.revocable=Proxy.revocable(s,this),this.proxy=this.revocable.proxy,this.target=s,this.options=this.processOptions(e.options)}processOptions(e){if(e){if("object"!=typeof e)throw new Error(`Observable options if/when provided, MAY only be an object, got '${e}'`);const t=Object.keys(e).filter(e=>!d.hasOwnProperty(e));if(t.length)throw new Error(`'${t.join(", ")}' is/are not a valid Observable option/s`);return Object.assign({},e)}return{}}detach(){return this.parent=null,this.target}set(e,t,r){let n=e[t];if(r!==n){const o=A(r,t,this);if(e[t]=o,n&&"object"==typeof n){const e=n[f];e&&(n=e.detach())}const s=void 0===n?[{type:"insert",path:[t],value:o,object:this.proxy}]:[{type:"update",path:[t],value:o,oldValue:n,object:this.proxy}];x(this,s)}return!0}deleteProperty(e,t){let r=e[t];if(delete e[t],r&&"object"==typeof r){const e=r[f];e&&(r=e.detach())}const n=[{type:"delete",path:[t],oldValue:r,object:this.proxy}];return x(this,n),!0}}class R extends P{constructor(e){super(e,g)}}class N extends P{constructor(e){super(e,m)}get(e,t){return _.hasOwnProperty(t)?_[t]:e[t]}}class k extends P{constructor(e){super(e,b)}get(e,t){return S.hasOwnProperty(t)?S[t]:e[t]}}class I{constructor(){throw new Error('Observable MAY NOT be created via constructor, see "Observable.from" API')}static from(e,t){if(e&&"object"==typeof e){if(e[f])return e;if(Array.isArray(e))return new N({target:e,ownKey:null,parent:null,options:t}).proxy;if(ArrayBuffer.isView(e))return new k({target:e,ownKey:null,parent:null,options:t}).proxy;if(e instanceof Date||e instanceof Error)throw new Error(e+" found to be one of a on-observable types");return new R({target:e,ownKey:null,parent:null,options:t}).proxy}throw new Error("observable MAY ONLY be created from a non-null object")}static isObservable(e){return!(!e||!e[f])}}Object.freeze(I);var $=r(11),D=r(12);function U(e){const t=e||c;return{generateAuthBody:()=>{const e=Date.now();return{token:t.token,token_time:~~(t.session/(e%64)),now:e}},generateBareUrl:(e,t)=>`https://api.easybase.io/${e}/${t}`,log:function(...e){t.options.logging&&console.log("EASYBASE — ",...e)}}}function M(e){const t=e||c,{generateBareUrl:r,generateAuthBody:o,log:s}=U(t);function i(){t.token="",t.refreshToken="",t.newTokenCallback()}const a=async()=>{const e=Date.now();t.session=Math.floor(1e8+9e8*Math.random()),s(`Handshaking on${t.instance} instance`);const o="PROJECT"===t.ebconfig.integration.split("-")[0].toUpperCase()?"PROJECT":"REACT";try{const i=await u()(r(o,t.integrationID),{method:"POST",headers:{"Eb-Post-Req":n.HANDSHAKE,Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({version:t.ebconfig.version,tt:t.ebconfig.tt,session:t.session,instance:t.instance})}),a=await i.json();if(a.token){t.token=a.token,t.mounted=!0;const r=await l(n.VALID_TOKEN),o=Date.now()-e;return!!r.success&&(s("Valid auth initiation in "+o+"ms"),!0)}return!1}catch(e){return console.error(e),!1}},l=async(e,s)=>{t.mounted||await a();const c="PROJECT"===t.ebconfig.integration.split("-")[0].toUpperCase()?"PROJECT":"REACT",p=await u()(r(c,t.integrationID),{method:"POST",headers:{"Eb-Post-Req":e,Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({_auth:o(),...s})}),f=await p.json();if({}.hasOwnProperty.call(f,"ErrorCode")||{}.hasOwnProperty.call(f,"code")){if("TokenExpired"===f.ErrorCode){if("PROJECT"===c)try{const r=await l(n.REQUEST_TOKEN,{refreshToken:t.refreshToken,token:t.token});if(r.success)return t.token=r.data.token,t.newTokenCallback(),l(e,s);throw new Error(r.data||"Error")}catch(e){return i(),{success:!1,data:e.message||e}}else await a();return l(e,s)}{const e=new Error(f.body||f.ErrorCode||f.code||"Error");throw e.errorCode=f.ErrorCode||f.code,e}}return{success:f.success,data:f.body}},p=async(e,s)=>{t.mounted||await a();const c=o(),f={"Eb-token":c.token,"Eb-token-time":c.token_time,"Eb-now":c.now},d="PROJECT"===t.ebconfig.integration.split("-")[0].toUpperCase()?"PROJECT":"REACT",h=await u()(r(d,t.integrationID),{method:"POST",headers:{"Eb-Post-Req":n.UPLOAD_ATTACHMENT,...s,...f},body:e}),y=await h.json();if({}.hasOwnProperty.call(y,"ErrorCode")||{}.hasOwnProperty.call(y,"code")){if("TokenExpired"===y.ErrorCode){if("PROJECT"===d)try{const r=await l(n.REQUEST_TOKEN,{refreshToken:t.refreshToken,token:t.token});if(r.success)return t.token=r.data.token,t.newTokenCallback(),p(e,s);throw new Error(r.data||"Error")}catch(e){return i(),{success:!1,data:e.message||e}}else await a();return p(e,s)}{const e=new Error(y.body||y.ErrorCode||y.code||"Error");throw e.errorCode=y.ErrorCode||y.code,e}}return{success:y.success,data:y.body}};return{initAuth:a,tokenPost:l,tokenPostAttachment:p,signUp:async(e,t,r)=>{try{const o=await l(n.SIGN_UP,{newUserID:e,password:t,userAttributes:r});return{success:o.success,message:o.data}}catch(e){return{success:!1,message:e.message||"Error",errorCode:e.errorCode||void 0}}},setUserAttribute:async(e,t)=>{try{const r=await l(n.SET_ATTRIBUTE,{key:e,value:t});return{success:r.success,message:JSON.stringify(r.data)}}catch(e){return{success:!1,message:e.message||"Error",errorCode:e.errorCode||void 0}}},getUserAttributes:async()=>{try{return(await l(n.USER_ATTRIBUTES)).data}catch(e){return s(e),e}},isUserSignedIn:()=>t.token.length>0,signIn:async(e,o)=>{const i=Date.now();t.session=Math.floor(1e8+9e8*Math.random());const a="PROJECT"===t.ebconfig.integration.split("-")[0].toUpperCase()?"PROJECT":"REACT";try{const c=await u()(r(a,t.integrationID),{method:"POST",headers:{"Eb-Post-Req":n.HANDSHAKE,Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({version:t.ebconfig.version,session:t.session,instance:t.instance,userID:e,password:o})}),p=await c.json();if(p.token){t.token=p.token,t.refreshToken=p.refreshToken,t.newTokenCallback(),t.mounted=!0;const e=await l(n.VALID_TOKEN),r=Date.now()-i;return e.success?(s("Valid auth initiation in "+r+"ms"),{success:!0,message:"Successfully signed in user"}):{success:!1,message:"Could not sign in user"}}return{success:!1,message:"Could not sign in user",errorCode:p.ErrorCode||void 0}}catch(e){return{success:!1,message:e.message||"Could not sign in user",errorCode:e.errorCode||void 0}}},signOut:()=>{t.token="",t.newTokenCallback()},resetUserPassword:async(e,t)=>{if("string"!=typeof t||t.length>100)return{success:!1,message:"newPassword must be of type string"};if("string"!=typeof e||e.length>100)return{success:!1,message:"currentPassword must be of type string"};try{const r=await l(n.RESET_PASSWORD,{currentPassword:e,newPassword:t});return{success:r.success,message:JSON.stringify(r.data)}}catch(e){return{success:!1,message:e.message||"Error",errorCode:e.errorCode||void 0}}},forgotPassword:async(e,t)=>{try{const r=await l(n.FORGOT_PASSWORD_SEND,{username:e,emailTemplate:t});return{success:r.success,message:r.data}}catch(e){return{success:!1,message:e.message||"Error",errorCode:e.errorCode||void 0}}},forgotPasswordConfirm:async(e,t,r)=>{try{const o=await l(n.FORGOT_PASSWORD_CONFIRM,{username:t,code:e,newPassword:r});return{success:o.success,message:o.data}}catch(e){return{success:!1,message:e.message||"Error",errorCode:e.errorCode||void 0}}}}}var q=r(6),B=r.n(q);function F({ebconfig:e,options:t}){const r={...i},{tokenPost:a,tokenPostAttachment:u,signUp:l,setUserAttribute:f,getUserAttributes:d,isUserSignedIn:h,signIn:y,signOut:g,resetUserPassword:m,forgotPassword:b,forgotPasswordConfirm:w}=M(r),{Query:E,fullTableSize:v,tableTypes:x}=function(e){const t=e||c,{tokenPost:r}=M(t);return{Query:async e=>{const t={queryName:"",...e},o=await r(n.GET_QUERY,t);return o.success?o.data:[]},fullTableSize:async function(e){const t=await r(n.TABLE_SIZE,e?{tableName:e}:{});return t.success?t.data:0},tableTypes:async function(e){const t=await r(n.COLUMN_TYPES,e?{tableName:e}:{});return t.success?t.data:{}}}}(r),{db:A,dbEventListener:O,e:j}=function(e){const t=e||c,{tokenPost:r}=M(t);let i=0;const a={};function u(...e){for(const t of Object.values(a))t(...e)}const l=async(e,t,i)=>{e.count="all",e.tableName=t,i&&(e.userAssociatedRecordsOnly=i),u(o.PENDING,e.type,s.ALL,"untable"!==t?t:null);try{const i=await r(n.EASY_QB,e);return i.success?(u(o.SUCCESS,e.type,s.ALL,"untable"!==t?t:null,i.data),i.data):(u(o.ERROR,e.type,s.ALL,"untable"!==t?t:null),i)}catch(r){return console.warn(r),u(o.ERROR,e.type,s.ALL,"untable"!==t?t:null),[]}},p=async(e,t,i)=>{e.count="one",e.tableName=t,i&&(e.userAssociatedRecordsOnly=i),u(o.PENDING,e.type,s.ONE,"untable"!==t?t:null);try{const i=await r(n.EASY_QB,e);return i.success?(u(o.SUCCESS,e.type,s.ONE,"untable"!==t?t:null,i.data),i.data):(u(o.ERROR,e.type,s.ONE,"untable"!==t?t:null),i)}catch(r){return console.warn(r),u(o.ERROR,e.type,s.ONE,"untable"!==t?t:null),{}}};return{db:(e,t)=>e&&"string"==typeof e?B()({allCallback:l,oneCallback:p,userAssociatedRecordsOnly:t,tableName:e.toUpperCase()})(e.replace(/[^0-9a-zA-Z]/g,"_").toUpperCase()):B()({allCallback:l,oneCallback:p,userAssociatedRecordsOnly:t,tableName:"untable"})("untable"),dbEventListener:e=>{const t=""+i++;return a[t]=e,()=>{delete a[t]}},e:B()().e}}(r),{log:T}=U(r);if("object"!=typeof e||null==e)return void console.error('No ebconfig object passed. do `import ebconfig from "./ebconfig.js"` and pass it to the Easybase provider');if(!e.integration)return void console.error("Invalid ebconfig object passed. Download ebconfig.js from Easybase.io and try again.");"undefined"!=typeof document&&!!document.documentMode&&console.error("EASYBASE — easybasejs does not support Internet Explorer. Please use a different browser."),r.options={...t},r.integrationID=e.integration,r.ebconfig=e,r.ebconfig.tt&&"PROJECT"!==r.ebconfig.integration.split("-")[0].toUpperCase()?r.mounted=!1:r.mounted=!0,r.instance="Node";let C=!0,_={offset:0,limit:0};const S=[];let P=new WeakMap,R={observe:e=>{},unobserve:()=>{}},N=[],k=!1;const q=async()=>{if(k)return{success:!1,message:"Easybase Error: the provider is currently syncing, use 'await sync()' before calling sync() again"};if(k=!0,C&&S.length>0){T("Stack change: ",S);(await a(n.SYNC_STACK,{stack:S,..._})).success&&(S.length=0)}try{const e=await a(n.GET_FRAME,_);return!1===e.success?(console.error(e.data),k=!1,{success:!1,message:""+e.data}):(C=!0,(e=>{let t=!0;if(e.length!==N.length)t=!1;else for(let r=0;r<e.length;r++){const n={...e[r]};if(delete n._id,!p()(n,N[r])){t=!1;break}}if(!t){const t=[...N];t.length=e.length,P=new WeakMap;for(let r=0;r<e.length;r++){const n=e[r];P.set(n,n._id),delete n._id,t[r]=n}N=t,R.unobserve(),R=I.from(N),R.observe(e=>{e.forEach(e=>{S.push({type:e.type,path:e.path,value:e.value,_id:P.get(N[Number(e.path[0])])}),T(JSON.stringify({type:e.type,path:e.path,value:e.value,_id:P.get(N[Number(e.path[0])])}))})})}})(e.data),k=!1,{message:"Success. Call frame for data",success:!0})}catch(e){return console.error("Easybase Error: get failed ",e),k=!1,{success:!1,message:"Easybase Error: get failed "+e,errorCode:e.errorCode||void 0}}},F=async(e,t)=>{const r=N.find(t=>p()(t,e.record));if(void 0===r||(n=r,!P.get(n)))return T("Attempting to add attachment to a new record that has not been synced. Please sync() before trying to add attachment."),{success:!1,message:"Attempting to add attachment to a new record that has not been synced. Please sync() before trying to add attachment."};var n;const o=e.attachment.name.split(".").pop().toLowerCase();if(T(o),"image"===t&&!$.includes(o))return{success:!1,message:"Image files must have a proper image extension in the file name"};if("video"===t&&!D.includes(o))return{success:!1,message:"Video files must have a proper video extension in the file name"};const s=new FormData;e.attachment.uri,s.append("file",e.attachment),s.append("name",e.attachment.name);const i={"Eb-upload-type":t,"Eb-column-name":e.columnName,"Eb-record-id":P.get(r),"Eb-table-name":e.tableName},a=await u(s,i);return await q(),{message:a.data,success:a.success}};return{configureFrame:e=>(_={..._},void 0!==e.limit&&(_.limit=e.limit),void 0!==e.offset&&e.offset>=0&&(_.offset=e.offset),void 0!==e.tableName&&(_.tableName=e.tableName),C=!1,{message:"Successfully configured frame. Run sync() for changes to be shown in frame",success:!0}),addRecord:async e=>{const t={...{insertAtEnd:!1,newRecord:{},tableName:void 0},...e};try{const e=await a(n.SYNC_INSERT,t);return{message:e.data,success:e.success}}catch(e){return console.error("Easybase Error: addRecord failed ",e),{message:"Easybase Error: addRecord failed "+e,success:!1,errorCode:e.errorCode||void 0}}},deleteRecord:async e=>{const t=N.find(t=>p()(t,e.record));if(t&&P.get(t)){const r=await a(n.SYNC_DELETE,{_id:P.get(t),tableName:e.tableName});return{success:r.success,message:r.data}}try{const t=await a(n.SYNC_DELETE,{record:e.record,tableName:e.tableName});return{success:t.success,message:t.data}}catch(e){return console.error("Easybase Error: deleteRecord failed ",e),{success:!1,message:"Easybase Error: deleteRecord failed "+e,errorCode:e.errorCode||void 0}}},sync:q,Frame:function(e){return"number"==typeof e?R[e]:R},currentConfiguration:()=>({..._}),updateRecordImage:async e=>await F(e,"image"),updateRecordVideo:async e=>await F(e,"video"),updateRecordFile:async e=>await F(e,"file"),fullTableSize:v,tableTypes:x,Query:E,isUserSignedIn:h,signIn:y,signOut:g,signUp:l,resetUserPassword:m,setUserAttribute:f,getUserAttributes:d,db:A,dbEventListener:O,e:j,forgotPassword:b,forgotPasswordConfirm:w}}const J=(e,t)=>`https://api.easybase.io/${e}/${t}`,K=e=>null!=e&&Math.floor(e)!==e,L=e=>null!=e&&"string"!=typeof e,V=e=>null==e||"string"!=typeof e,z=e=>null!=e&&"object"!=typeof e;function Y(e){const t={integrationID:"",offset:void 0,limit:void 0,authentication:void 0,customQuery:void 0},{integrationID:r,offset:n,limit:o,authentication:s,customQuery:i}={...t,...e};if(V(r))throw new Error("integrationID is required and must be a string");if(K(n))throw new Error("offset must be an integer");if(K(o))throw new Error("limit must be an integer");if(L(s))throw new Error("authentication must be a string or null");if(z(i))throw new Error("customQuery must be an object or null");return new Promise((e,t)=>{try{let t={};"object"==typeof i&&(t={...i}),void 0!==n&&(t.offset=n),void 0!==o&&(t.limit=o),void 0!==s&&(t.authentication=s),u()(J("get",r),{method:"POST",body:JSON.stringify(t),headers:{Accept:"application/json","Content-Type":"application/json"}}).then(e=>e.json()).then(t=>{!{}.hasOwnProperty.call(t,"ErrorCode")?e(t):(console.error(t.message),e([t.message]))})}catch(e){t(e)}})}function G(e){const t={integrationID:"",newRecord:void 0,authentication:void 0,insertAtEnd:void 0},{integrationID:r,newRecord:n,authentication:o,insertAtEnd:s}={...t,...e};if(V(r))throw new Error("integrationID is required and must be a string");if(z(n))throw new Error("newRecord is required and must be a string");if(L(o))throw new Error("authentication must be a string or null");if(null!=(i=s)&&"boolean"!=typeof i)throw new Error("insertAtEnd must be a boolean or null");var i;return new Promise((e,t)=>{try{const t={...n};void 0!==o&&(t.authentication=o),void 0!==s&&(t.insertAtEnd=s),u()(J("post",r),{method:"POST",body:JSON.stringify(t),headers:{Accept:"application/json","Content-Type":"application/json"}}).then(e=>e.json()).then(t=>{({}).hasOwnProperty.call(t,"ErrorCode")&&console.error(t.message),e(t)})}catch(e){t(e)}})}function Q(e){const t={integrationID:"",updateValues:void 0,authentication:void 0,customQuery:void 0},{integrationID:r,updateValues:n,authentication:o,customQuery:s}={...t,...e};if(V(r))throw new Error("integrationID is required and must be a string");if(z(n)||void 0===n)throw new Error("updateValues is required and must be a string");if(L(o))throw new Error("authentication must be a string or null");if(z(s))throw new Error("customQuery must be an object or null");return new Promise((e,t)=>{try{const t={updateValues:n,...s};void 0!==o&&(t.authentication=o),u()(J("update",r),{method:"POST",body:JSON.stringify(t),headers:{Accept:"application/json","Content-Type":"application/json"}}).then(e=>e.json()).then(t=>{({}).hasOwnProperty.call(t,"ErrorCode")&&console.error(t.message),e(t.message)})}catch(e){t(e)}})}function H(e){const t={integrationID:"",authentication:void 0,customQuery:void 0},{integrationID:r,authentication:n,customQuery:o}={...t,...e};if(V(r))throw new Error("integrationID is required and must be a string");if(L(n))throw new Error("authentication must be a string or null");if(z(o))throw new Error("customQuery must be an object or null");return new Promise((e,t)=>{try{const t={...o};void 0!==n&&(t.authentication=n),u()(J("delete",r),{method:"POST",body:JSON.stringify(t),headers:{Accept:"application/json","Content-Type":"application/json"}}).then(e=>e.json()).then(t=>{({}).hasOwnProperty.call(t,"ErrorCode")&&console.error(t.message),e(t.message)})}catch(e){t(e)}})}async function W(e,t){const r=await u()(J("function",e.split("/").pop()),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)||""});return await r.text()}}])}));
//# sourceMappingURL=bundle.js.map